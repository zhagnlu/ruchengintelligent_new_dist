<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Force Create Language Selector Test</title>
  <link rel="stylesheet" href="css/main.min.css">
</head>
<body>
  <div id="header-placeholder"></div>

  <div style="padding: 40px; max-width: 800px; margin: 0 auto;">
    <h1>Language Selector Test Page</h1>
    <p>This page will force create the language selector for testing.</p>

    <button onclick="forceCreateSelector()" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #0074c2; color: white; border: none; border-radius: 6px;">
      Force Create Language Selector
    </button>

    <div id="debug-output" style="margin-top: 20px; padding: 20px; background: #f5f5f5; border-radius: 6px; font-family: monospace; white-space: pre-wrap;"></div>
  </div>

  <div id="footer-placeholder"></div>

  <script src="js/translator-loader.js"></script>
  <script src="js/components.min.js"></script>

  <script>
    function log(message) {
      const output = document.getElementById('debug-output');
      output.textContent += message + '\n';
      console.log(message);
    }

    function forceCreateSelector() {
      log('=== Starting Force Create ===');

      // Clear debug output
      document.getElementById('debug-output').textContent = '';

      log('1. Checking TranslatorLoader class: ' + (typeof TranslatorLoader));
      log('2. Header exists: ' + !!document.querySelector('.main-header'));
      log('3. Nav menu exists: ' + !!document.querySelector('.nav-menu'));

      // Check all links
      const navMenu = document.querySelector('.nav-menu');
      if (navMenu) {
        const allLinks = navMenu.querySelectorAll('a');
        log('4. Found ' + allLinks.length + ' links in nav menu:');
        allLinks.forEach((link, i) => {
          log('   ' + i + ': "' + link.textContent.trim() + '"');
        });
      }

      // Remove existing selector
      const existing = document.querySelector('.language-selector');
      if (existing) {
        existing.remove();
        log('5. Removed existing language selector');
      }

      // Create new instance
      try {
        log('6. Creating new TranslatorLoader instance...');
        const loader = new TranslatorLoader();

        log('7. Calling createPlaceholder()...');
        loader.createPlaceholder();

        // Check if created
        const created = document.querySelector('.language-selector');
        if (created) {
          log('✅ SUCCESS! Language selector created');
          log('   Button text: ' + document.querySelector('.current-lang')?.textContent);
        } else {
          log('❌ FAILED! Language selector not found after creation');
        }

        // Store globally
        window.testLoader = loader;
        log('8. Stored loader in window.testLoader');

      } catch (error) {
        log('❌ ERROR: ' + error.message);
        console.error(error);
      }

      log('=== Force Create Complete ===');
    }

    // Auto-run after page loads
    window.addEventListener('load', () => {
      setTimeout(() => {
        log('Page loaded, waiting 2 seconds before auto-creating...');
        setTimeout(forceCreateSelector, 2000);
      }, 100);
    });
  </script>
</body>
</html>
