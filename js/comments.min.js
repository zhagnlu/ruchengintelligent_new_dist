class CommentsSystem{constructor(e,n={}){this.containerId=e,this.container=document.getElementById(e),this.storageKey=n.storageKey||"comments_system",this.articleId=n.articleId||"default",this.maxComments=n.maxComments||100,this.init()}init(){this.container&&(this.render(),this.bindEvents(),this.loadComments())}render(){this.container.innerHTML='\n      <section class="comments-section">\n        <h3 class="comments-title">\n          Comments <span class="comment-count">(0)</span>\n        </h3>\n\n        \x3c!-- Success Message --\x3e\n        <div class="success-message" id="successMessage">\n          Your comment has been submitted successfully!\n        </div>\n\n        \x3c!-- Comment Form --\x3e\n        <div class="comment-form">\n          <h4 class="form-title">Leave a Comment</h4>\n          <form id="commentForm">\n            <div class="form-row">\n              <div class="form-group">\n                <label for="name" class="form-label">Name *</label>\n                <input type="text" id="name" name="name" class="form-input" required>\n              </div>\n              <div class="form-group">\n                <label for="email" class="form-label">Email *</label>\n                <input type="email" id="email" name="email" class="form-input" required>\n              </div>\n            </div>\n            <div class="form-group">\n              <label for="comment" class="form-label">Comment *</label>\n              <textarea id="comment" name="comment" class="form-textarea" placeholder="Share your thoughts..." required></textarea>\n            </div>\n            <button type="submit" class="submit-btn" id="submitBtn">\n              <span class="btn-text">Post Comment</span>\n              <span class="btn-loading" style="display: none;">Posting...</span>\n            </button>\n          </form>\n        </div>\n\n        \x3c!-- Comments List --\x3e\n        <div class="comments-list" id="commentsList">\n          \x3c!-- Comments will be loaded dynamically from localStorage --\x3e\n        </div>\n      </section>\n    ',this.addStyles()}addStyles(){if(document.getElementById("comments-styles"))return;const e=document.createElement("style");e.id="comments-styles",e.textContent="\n      /* Comments Section */\n      .comments-section {\n        margin-top: 60px;\n        padding-top: 40px;\n        border-top: 1px solid #eee;\n      }\n\n      .comments-title {\n        font-size: 1.8rem;\n        font-weight: 600;\n        color: #333;\n        margin-bottom: 30px;\n        text-align: center;\n      }\n\n      .comment-count {\n        color: #666;\n        font-size: 1rem;\n        font-weight: normal;\n      }\n\n      /* Comment Form */\n      .comment-form {\n        background: #f8f9fa;\n        padding: 30px;\n        border-radius: 10px;\n        margin-bottom: 40px;\n      }\n\n      .form-title {\n        font-size: 1.3rem;\n        font-weight: 600;\n        color: #333;\n        margin-bottom: 20px;\n      }\n\n      .form-group {\n        margin-bottom: 20px;\n      }\n\n      .form-label {\n        display: block;\n        font-weight: 600;\n        color: #333;\n        margin-bottom: 8px;\n      }\n\n      .form-input,\n      .form-textarea {\n        width: 100%;\n        padding: 12px 15px;\n        border: 2px solid #e1e5e9;\n        border-radius: 6px;\n        font-size: 1rem;\n        font-family: inherit;\n        transition: border-color 0.3s ease;\n        box-sizing: border-box;\n      }\n\n      .form-input:focus,\n      .form-textarea:focus {\n        outline: none;\n        border-color: #0074c2;\n      }\n\n      .form-textarea {\n        min-height: 120px;\n        resize: vertical;\n      }\n\n      .form-row {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 20px;\n      }\n\n      .submit-btn {\n        background: #0074c2;\n        color: white;\n        border: none;\n        padding: 12px 30px;\n        font-size: 1rem;\n        font-weight: 600;\n        border-radius: 6px;\n        cursor: pointer;\n        transition: all 0.3s ease;\n      }\n\n      .submit-btn:hover {\n        background: #0056b3;\n        transform: translateY(-2px);\n      }\n\n      .submit-btn:disabled {\n        background: #ccc;\n        cursor: not-allowed;\n        transform: none;\n      }\n\n      /* Comments List */\n      .comments-list {\n        margin-top: 40px;\n      }\n\n      .comment-item {\n        background: white;\n        border: 1px solid #e1e5e9;\n        border-radius: 8px;\n        padding: 25px;\n        margin-bottom: 20px;\n        transition: box-shadow 0.3s ease;\n      }\n\n      .comment-item:hover {\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      }\n\n      .comment-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 15px;\n      }\n\n      .comment-author {\n        font-weight: 600;\n        color: #333;\n        font-size: 1.1rem;\n      }\n\n      .comment-date {\n        color: #666;\n        font-size: 0.9rem;\n      }\n\n      .comment-content {\n        color: #333;\n        line-height: 1.6;\n        font-size: 1rem;\n      }\n\n      .comment-actions {\n        margin-top: 15px;\n        display: flex;\n        gap: 15px;\n      }\n\n      .action-btn {\n        background: none;\n        border: none;\n        color: #0074c2;\n        font-size: 0.9rem;\n        cursor: pointer;\n        padding: 5px 0;\n        transition: color 0.3s ease;\n      }\n\n      .action-btn:hover {\n        color: #0056b3;\n        text-decoration: underline;\n      }\n\n      .like-btn {\n        display: flex;\n        align-items: center;\n        gap: 5px;\n      }\n\n      .like-count {\n        color: #666;\n      }\n\n      .like-btn.liked {\n        color: #e74c3c;\n      }\n\n      .like-btn.liked .like-count {\n        color: #e74c3c;\n      }\n\n      /* Reply Form */\n      .reply-form {\n        margin-top: 15px;\n        padding: 20px;\n        background: #f8f9fa;\n        border-radius: 6px;\n        display: none;\n      }\n\n      .reply-form.active {\n        display: block;\n      }\n\n      .reply-textarea {\n        width: 100%;\n        padding: 10px;\n        border: 1px solid #e1e5e9;\n        border-radius: 4px;\n        font-size: 0.9rem;\n        font-family: inherit;\n        min-height: 80px;\n        resize: vertical;\n        margin-bottom: 10px;\n      }\n\n      .reply-buttons {\n        display: flex;\n        gap: 10px;\n      }\n\n      .reply-submit {\n        background: #0074c2;\n        color: white;\n        border: none;\n        padding: 8px 16px;\n        font-size: 0.9rem;\n        border-radius: 4px;\n        cursor: pointer;\n      }\n\n      .reply-cancel {\n        background: #6c757d;\n        color: white;\n        border: none;\n        padding: 8px 16px;\n        font-size: 0.9rem;\n        border-radius: 4px;\n        cursor: pointer;\n      }\n\n      /* Success Message */\n      .success-message {\n        background: #d4edda;\n        color: #155724;\n        padding: 15px;\n        border-radius: 6px;\n        margin-bottom: 20px;\n        display: none;\n      }\n\n      .success-message.show {\n        display: block;\n      }\n\n      /* Responsive Design */\n      @media (max-width: 768px) {\n        .form-row {\n          grid-template-columns: 1fr;\n          gap: 15px;\n        }\n\n        .comment-form {\n          padding: 20px;\n        }\n\n        .comment-header {\n          flex-direction: column;\n          align-items: flex-start;\n          gap: 10px;\n        }\n\n        .comment-actions {\n          flex-wrap: wrap;\n        }\n      }\n\n      @media (max-width: 480px) {\n        .comment-form {\n          padding: 15px;\n        }\n\n        .comment-item {\n          padding: 20px;\n        }\n      }\n    ",document.head.appendChild(e)}bindEvents(){const e=this.container.querySelector("#commentForm"),n=this.container.querySelector("#commentsList");e.addEventListener("submit",e=>this.handleCommentSubmit(e)),n.addEventListener("click",e=>this.handleLikeClick(e)),n.addEventListener("click",e=>this.handleReplyClick(e)),n.addEventListener("click",e=>this.handleReplySubmit(e))}handleCommentSubmit(e){e.preventDefault();const n=new FormData(e.target),t=n.get("name"),o=n.get("email"),i=n.get("comment"),s=this.container.querySelector("#submitBtn"),r=s.querySelector(".btn-text"),a=s.querySelector(".btn-loading");s.disabled=!0,r.style.display="none",a.style.display="inline";const m={id:Date.now(),name:t,email:o,comment:i,date:(new Date).toISOString(),likes:0,liked:!1,replies:[]};this.saveComment(m),setTimeout(()=>{const n=this.createCommentElement(m),t=this.container.querySelector("#commentsList");t.insertBefore(n,t.firstChild),this.updateCommentCount(),this.showSuccessMessage(),e.target.reset(),s.disabled=!1,r.style.display="inline",a.style.display="none"},1500)}handleLikeClick(e){if(e.target.closest(".like-btn")){const n=e.target.closest(".like-btn"),t=n.closest(".comment-item"),o=parseInt(t.getAttribute("data-comment-id")),i=n.querySelector(".like-count"),s=parseInt(i.textContent);n.classList.contains("liked")?(n.classList.remove("liked"),i.textContent=s-1,this.updateCommentLike(o,s-1,!1)):(n.classList.add("liked"),i.textContent=s+1,this.updateCommentLike(o,s+1,!0))}}handleReplyClick(e){if(e.target.closest(".reply-btn")){const n=e.target.closest(".comment-item").querySelector(".reply-form");this.container.querySelectorAll(".reply-form").forEach(e=>{e!==n&&e.classList.remove("active")}),n.classList.toggle("active"),n.classList.contains("active")&&n.querySelector(".reply-textarea").focus()}}handleReplySubmit(e){if(e.target.classList.contains("reply-submit")){const n=e.target.closest(".reply-form"),t=n.querySelector(".reply-textarea"),o=t.value.trim();if(o){const e=n.closest(".comment-item"),i=parseInt(e.getAttribute("data-comment-id")),s={id:Date.now(),text:o,date:(new Date).toISOString()};this.saveReply(i,s);const r=this.createReplyElement(s);e.querySelector(".comment-content").appendChild(r),t.value="",n.classList.remove("active")}}if(e.target.classList.contains("reply-cancel")){const n=e.target.closest(".reply-form");n.querySelector(".reply-textarea").value="",n.classList.remove("active")}}saveComment(e){const n=this.getComments();n.unshift(e),n.length>this.maxComments&&n.splice(this.maxComments),localStorage.setItem(this.getStorageKey(),JSON.stringify(n))}getComments(){const e=localStorage.getItem(this.getStorageKey());return e?JSON.parse(e):this.getDefaultComments()}getStorageKey(){return`${this.storageKey}_${this.articleId}`}updateCommentLike(e,n,t){const o=this.getComments(),i=o.findIndex(n=>n.id===e);-1!==i&&(o[i].likes=n,o[i].liked=t,localStorage.setItem(this.getStorageKey(),JSON.stringify(o)))}saveReply(e,n){const t=this.getComments(),o=t.findIndex(n=>n.id===e);-1!==o&&(t[o].replies||(t[o].replies=[]),t[o].replies.push(n),localStorage.setItem(this.getStorageKey(),JSON.stringify(t)))}getDefaultComments(){return[{id:1,name:"John Smith",email:"john@example.com",comment:"Great article! I've been looking for information about CNC sheet metal machinery and this provides excellent insights. The R&D focus is particularly impressive.",date:"2024-03-15T10:30:00.000Z",likes:5,liked:!1,replies:[]},{id:2,name:"Sarah Johnson",email:"sarah@example.com",comment:"The 20 years of experience really shows in the quality of their products. I'm interested in learning more about their custom solutions for metal forming needs.",date:"2024-03-12T14:20:00.000Z",likes:3,liked:!1,replies:[]},{id:3,name:"Mike Chen",email:"mike@example.com",comment:"Excellent overview of Rucheng Technology's capabilities. The international quality management systems and global standards compliance are crucial for our industry.",date:"2024-03-10T09:15:00.000Z",likes:7,liked:!0,replies:[]}]}loadComments(){const e=this.getComments(),n=this.container.querySelector("#commentsList");n.innerHTML="",e.forEach(e=>{const t=this.createCommentElement(e);n.appendChild(t)}),this.updateCommentCount()}createCommentElement(e){const n=document.createElement("div");n.className="comment-item",n.setAttribute("data-comment-id",e.id);const t=new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o=e.liked?"liked":"";return n.innerHTML=`\n      <div class="comment-header">\n        <div class="comment-author">${e.name}</div>\n        <div class="comment-date">${t}</div>\n      </div>\n      <div class="comment-content">\n        ${e.comment}\n        ${e.replies.map(e=>this.createReplyHTML(e)).join("")}\n      </div>\n      <div class="comment-actions">\n        <button class="action-btn like-btn ${o}" data-likes="${e.likes}">\n          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">\n            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>\n          </svg>\n          <span class="like-count">${e.likes}</span>\n        </button>\n        <button class="action-btn reply-btn">Reply</button>\n      </div>\n      <div class="reply-form">\n        <textarea class="reply-textarea" placeholder="Write your reply..."></textarea>\n        <div class="reply-buttons">\n          <button class="reply-submit">Submit Reply</button>\n          <button class="reply-cancel">Cancel</button>\n        </div>\n      </div>\n    `,n}createReplyElement(e){const n=document.createElement("div");n.className="reply-item",n.style.cssText="\n      margin-top: 15px;\n      padding: 15px;\n      background: #f8f9fa;\n      border-left: 3px solid #0074c2;\n      border-radius: 0 6px 6px 0;\n    ";const t=new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return n.innerHTML=`\n      <div style="font-weight: 600; color: #333; margin-bottom: 5px;">You replied</div>\n      <div style="color: #333; line-height: 1.5;">${e.text}</div>\n      <div style="color: #666; font-size: 0.9rem; margin-top: 8px;">${t}</div>\n    `,n}createReplyHTML(e){const n=new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return`\n      <div class="reply-item" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-left: 3px solid #0074c2; border-radius: 0 6px 6px 0;">\n        <div style="font-weight: 600; color: #333; margin-bottom: 5px;">You replied</div>\n        <div style="color: #333; line-height: 1.5;">${e.text}</div>\n        <div style="color: #666; font-size: 0.9rem; margin-top: 8px;">${n}</div>\n      </div>\n    `}updateCommentCount(){const e=this.container.querySelector(".comment-count"),n=this.container.querySelectorAll(".comment-item").length;e.textContent=`(${n})`}showSuccessMessage(){const e=this.container.querySelector("#successMessage");e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},3e3)}scrollToComments(){this.container.scrollIntoView({behavior:"smooth"}),this.container.querySelector("#name").focus()}clearComments(){localStorage.removeItem(this.getStorageKey()),this.loadComments()}getCommentCount(){return this.container.querySelectorAll(".comment-item").length}}"undefined"!=typeof module&&module.exports?module.exports=CommentsSystem:window.CommentsSystem=CommentsSystem;